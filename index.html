<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Call Bridge — Tech Talk Titans</title>
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self';
                 script-src 'self' https://sdk.twilio.com https://cdn.jsdelivr.net;
                 connect-src 'self' https://callbridge.onrender.com https://*.twilio.com wss://*.twilio.com;
                 style-src 'self' 'unsafe-inline';
                 img-src 'self' data:;
                 font-src 'self' data:;">
  <script src="https://sdk.twilio.com/js/voice/releases/2.0.1/twilio.min.js"></script>
  <style>
    :root{ --bg:#f4f6f9; --card:#fff; --muted:#6b7280; --accent:#2563eb; --green:#10b981; --danger:#ef4444; --shadow:0 8px 30px rgba(2,6,23,.08) }
    *{box-sizing:border-box;font-family:Inter,system-ui,Segoe UI,Arial}
    html,body{height:100%;margin:0;background:var(--bg)}
    body{display:flex;align-items:center;justify-content:center}
    .card{background:var(--card);border-radius:12px;padding:28px;box-shadow:var(--shadow);width:340px}
    h2{margin:0 0 12px 0;text-align:center}
    .muted{color:var(--muted);font-size:13px;text-align:center;margin-bottom:10px}
    .btn{padding:10px 14px;border-radius:10px;border:none;cursor:pointer;color:#fff;width:100%;margin-top:10px}
    .btn.primary{background:var(--accent)}
    input{width:100%;padding:10px;border:1px solid #e6e9ef;border-radius:10px;margin-top:8px}
  </style>
</head>
<body>
  <div class="card" id="authCard">
    <h2>Sign in</h2>
    <div class="muted">Use your assigned email & password</div>
    <input id="email" type="email" placeholder="you@example.com" autocomplete="email" required>
    <input id="password" type="password" placeholder="Password" autocomplete="current-password" required>
    <button id="loginBtn" class="btn primary">Login</button>
    <div id="authErr" class="muted" style="color:#b91c1c;margin-top:10px"></div>
  </div>

<script>
(() => {
  const API_BASE = "https://callbridge.onrender.com";
  const emailInput = document.getElementById("email");
  const passwordInput = document.getElementById("password");
  const err = document.getElementById("authErr");
  const card = document.getElementById("authCard");

  document.getElementById("loginBtn").onclick = async () => {
    const email = emailInput.value.trim();
    const password = passwordInput.value.trim();
    err.innerText = "";
    if (!email || !password) { err.innerText="Enter both email and password."; return; }
    try {
      const res = await fetch(`${API_BASE}/login`, {
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({email,password})
      });
      const data = await res.json().catch(()=>({}));
      if (!res.ok) throw new Error(data?.error || "Login failed");
      console.log("✅ Login success:", data);
      card.innerHTML = "<h2>Welcome!</h2><p class='muted'>You are successfully logged in.</p>";
    } catch(e){ err.innerText = e.message; console.error(e); }
  };
})();
</script>
</body>
</html>
